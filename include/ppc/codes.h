#pragma once

#include <unordered_map>
#include <set>
#include <string>

namespace PPC {

	// Codes to names

	static const std::unordered_map<ulong, std::string> primary_codes({{3, "twi"},{4, "UNKNOWN PAIRED-SINGLE"},{7, "mulli"},{8, "subfic"},{10, "cmpli"},{11, "cmpi"},{12, "addic"},{13, "addic."},
		{14, "addi"},{15, "addis"},{16, "bc"},{17, "sc"},{18, "b"},{19, "UNKNOWN SPEC BRANCH"},{20, "rlwimi"},{21, "rlwinm"},{23, "rlwnm"},{24, "ori"},{25, "oris"},{26, "xori"},
		{27, "xoris"},{28, "andi."},{29, "andis."},{31, "UNKNOWN MATH"},{32, "lwz"},{33, "lwzu"},{34, "lbz"},{35, "lbzu"},{36, "stw"},{37, "stwu"},{38, "stb"},{39, "stbu"},
		{40, "lhz"},{41, "lhzu"},{42, "lha"},{43, "lhau"},{44, "sth"},{45, "sthu"},{46, "lmw"},{47, "smtw"},{48, "lfs"},{49, "lfsu"},{50, "lfd"},{51, "lfdu"},{52, "stfs"},
		{53, "stfsu"},{54, "stfd"},{55, "stfdu"},{56, "ps_l"},{57, "ps_lu"},{59, "UNKNOWN FLOATING SINGLE"},{60, "ps_st"},{61, "ps_stu"},{63, "UNKNOWN FLOATING DOUBLE"}
		});

	static const std::unordered_map<ulong, std::string> secondary_codes_ps({
		{0, "ps_cmp"},{6, "ps_lx"},{7, "ps_stx"},{8, "UNKNOWN ABS/NEGATE"},{10, "ps_sum0"},{11, "ps_sum1"},{12, "ps_muls0"},{13, "ps_muls1"},{14, "ps_madds0"},{15, "ps_madds1"},{16, "ps_merge"},
		{18, "ps_div"},{20, "ps_sub"},{21, "ps_add"},{23, "ps_sel"},{24, "ps_res"},{25, "ps_mul"},{26, "ps_rsqrte"},{28, "ps_msub"},{29, "ps_madd"},{30, "ps_nmsub"},
		{31, "ps_nmadd"}, {40, "ps_neg"}, {72, "ps_mr"}, {136, "ps_nabs"}, {264, "ps_abs"}, {1014, "dcbz_l"}
		});

	static const std::unordered_map<ulong, std::string> secondary_codes_sb({
		{0, "mcrf"},{16, "bclr"},{33, "crnor"},{50 ,"rfi"},{129, "crandc"},{150, "isync"},{193, "crxor"},{225, "crnand"},{257, "crand"},{289, "creqv"},
		{417, "crorc"},{449, "cror"},{528, "bcctr"}
		});

	static const std::unordered_map<ulong, std::string> secondary_codes_math({
		{0, "cmp"},{4, "tw"},{8, "subfc"},{10, "addc"},{11, "mulhwu"},{19, "mfcr"},{20, "lwarx"},{23, "lwzx"},{24, "slw"},{26, "cntlzw"},{28, "and"},{32, "cmpl"},
		{40, "subf"},{54, "dcbst"},{55, "lwzux"},{60, "andc"},{75, "mulhw"},{83, "mfmsr"},{86, "dcbf"},{87, "lbzx"},{104, "neg"},{119, "lbzux"},{124, "nor"},
		{136, "subfe"},{138, "adde"},{144, "mtcrf"},{146, "mtmsr"},{150, "stwcx"},{151, "stwx"},{183, "stwux"},{200, "subfze"},{202, "addze"},{210, "mtsr"},
		{215, "stbx"},{232, "subfme"},{234, "addme"},{235, "mullw"},{242, "mtsrin"},{246, "dcbtst"},{247, "stbux"},{266, "add"},{278, "dcbt"},{279, "lhzx"},
		{284, "eqv"},{306, "tlbie"},{310, "eciwx"},{311, "lhzux"},{316, "xor"},{339, "mfspr"},{343, "lhax"},{370, "tlbia"},{371, "mftb"},{375, "lhaux"},{407, "sthx"},
		{412, "orc"},{438, "ecowx"},{439, "sthux"},{444, "or"},{459, "divwu"},{467, "mtspr"},{470, "dcbi"},{476, "nand"},{491, "divw"},{512, "mcrxr"},{520, "subfco"},
		{522, "addco"},{533, "lswx"},{534, "lwbrx"},{535, "lfsx"},{536, "srw"},{552, "subfo"},{566, "tlbsync"},{567, "lfsux"},{595, "mfsr"},{597, "lswi"},
		{598, "sync"},{599, "lfdx"},{616, "nego"},{631, "lfdux"},{648, "subfeo"},{650, "addeo"},{661, "stswx"},{662, "stwbrx"},{663, "stfsx"},{695, "stfsux"},
		{712, "subfzeo"},{714, "addzeo"},{725, "stswi"},{727, "stfdx"},{744, "subfmeo"},{746, "addmeo"},{747, "mullwo"},{758, "dcba"},{759, "stfdux"},{778, "addo"},
		{790, "lhbrx"},{792, "sraw"},{824, "srawi"},{854, "eieio"},{918, "sthbrx"},{922, "extsh"},{954, "extsb"},{971, "divwuo"},{982, "icbi"},{983, "stfiwx"},
		{1003, "divwo"},{1014, "dcbz"}
		});

	static const std::unordered_map<ulong, std::string> secondary_codes_float({
		{18, "fdivs"},{20, "fsubs"},{21, "fadds"},{22, "fsqrts"},{24, "fres"},{25, "fmuls"},{28, "fmsubs"},{29, "fmadds"},{30, "fnmsubs"},{31, "fnmadds"}
		});

	static const std::unordered_map<ulong, std::string> secondary_codes_double({
		{0, "fcmpu"},{12, "frsp"},{14, "fctiw"},{15, "fctiwz"},{18, "fdiv"},{20, "fsub"},{21, "fadd"},{22, "fsqrt"},{23, "fsel"},{25, "fmul"},{26, "frsqrte"},
		{28, "fmsub"},{29, "fmadd"},{30, "fnmsub"},{31, "fnmadd"},{32, "fcmpo"},{38, "mtfsb1"},{40, "fneg"},{64, "mcrfs"},{70, "mtfsb0"},{72, "fmr"},
		{134, "mtfsfi"},{136, "fnabs"},{264, "fabs"},{583, "mffs"},{711, "mtfsf"}
		});

	// Codes to patterns

	static const std::unordered_map<ulong, std::string> primary_patterns({
		{3, "{b0:X6,10}, r{b0:11,15}, {b0:sX16,31}"},{7, "r{b0:6,10}, r{b0:11,15}, {b0:sX16,31}"},{8, "r{b0:6,10}, r{b0:11,15}, {b0:sX16,31}"},{13, "r{b0:6,10}, r{b0:11,15}, {b0:sX16,31}"},{14, "r{b0:6,10}, r{b0:11,15}, {b0:sX16,31}"},
		{16, "{b0:6,10}, {b0:11,15}, {b0:X16,29}"},{17, "{b0:}"},{18, "{b0:X6,29}"},{19, "crb{b0:6,10}, crb{b0:11,15}, crb{b0:16,20}"},{20, "r{b0:11,15}, r{b0:6,10}, {b0:X16,20}, {b0:X21,25}, {b0:X26,30}"},
		{21, "r{b0:11,15}, r{b0:6,10}, {b0:X16,20}, {b0:X21,25}, {b0:X26,30}"},{23, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}, {b0:X21,25}, {b0:X26,30}"},{24, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},
		{25, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},{26, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},{27, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},{28, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},{29, "r{b0:11,15}, r{b0:6,10}, {b0:X16,31}"},
		{31, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{32, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{33, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{34, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{35, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},
		{36, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{37, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{38, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{39, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{40, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},
		{41, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{42, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{43, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{44, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{45, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},
		{46, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{47, "r{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{48, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{49, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{50, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},
		{51, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{52, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{53, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{54, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},
		{55, "fr{b0:6,10}, {b0:X16,31}(r{b0:11,15})"},{56, "r{b0:6,10}, r{b0:11,15}, W{b0:16,19}, {b0:X20,31}"},{57, "r{b0:6,10}, r{b0:11,15}, W{b0:16,19}, {b0:X20,31}"},{59, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},
		{60, "r{b0:11,15}, r{b0:6,10}, W{b0:16,19}, {b0:X20,31}"},{61, "r{b0:11,15}, r{b0:6,10}, W{b0:16,19}, {b0:X20,31}"}
		});

	static const std::unordered_map<ulong, std::string> secondary_patterns_ps({
		{0, "crf{b0:6,8}, r{b0:11,15}, r{b0:16,20}"},{6, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, W{b0:21,24}"},{7, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}, W{b0:21,24}"},{8, "r{b0:6,10}, r{b0:16,20}"},{10, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},
		{11, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{12, "r{b0:6,10}, r{b0:11,15}, r{b0:21,25}"},{13, "r{b0:6,10}, r{b0:11,15}, r{b0:21,25}"},{14, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},
		{15, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{16, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{18, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{20, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},
		{21, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{23, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{24, "r{b0:6,10}, r{b0:16,20}"},{25, "r{b0:6,10}, r{b0:11,15}, r{b0:21,25}"},{26, "r{b0:6,10}, r{b0:16,20}"},
		{28, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{29, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{30, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},{31, "r{b0:6,10}, r{b0:11,15}, r{b0:16,20}, r{b0:21,25}"},
        {40, "fr{b0:6,10}, fr{b0:16,20}"},{72, "fr{b0:6,10}, fr{b0:16,20}"},{136, "fr{b0:6,10}, fr{b0:16,20}"},{264, "fr{b0:6,10}, fr{b0:16,20}"},{1014, "r{b0:11,15}, r{b0:16,20}"}
		});

	static const std::unordered_map<ulong, std::string> secondary_patterns_sb({
		{0, "crf{b0:6,8}, crf{b0:11,13}"},{50, "{b0:}"},{150, "{b0:}"}
		});

	static const std::unordered_map<ulong, std::string> secondary_patterns_math({
		{4, "{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{19, "r{b0:6,10}"},{24, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{26, "r{b0:6,10}, r{b0:11,15}"},{28, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{54, "r{b0:11,15}, r{b0:16,20}"},
		{60, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{83, "r{b0:6,10}"},{86, "r{b0:11,15}, r{b0:16,20}"},{104, "r{b0:6,10}, r{b0:11,15}"},{124, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{146, "r{b0:6,10}"},{200, "r{b0:6,10}, r{b0:11,15}"},
		{202, "r{b0:6,10}, r{b0:11,15}"},{210, "{b0:12,15}, r{b0:6,10}"},{232, "r{b0:6,10}, r{b0:11,15}"},{234, "r{b0:6,10}, r{b0:11,15}"},{242, "r{b0:6,10}, r{b0:16,20}"},{246, "r{b0:11,15}, r{b0:16,20}"},
		{284, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{316, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{444, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{278, "r{b0:11,15}, r{b0:16,20}"},{306, "r{b0:16,20}"},{370, "{b0:}"},
		{412, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{444, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{470, "r{b0:11,15}, r{b0:16,20}"},{512, "crf{b0:6,8}"},{476, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},
		{535, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{536, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{566,"{b0:}"},{567, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{595, "r{b0:6,10}, {b0:12,15}"},{597, "r{b0:6,10}, r{b0:11,15}, {b0:X16,20}"},
		{598, "{b0:}"},{599, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{616, "r{b0:6,10}, r{b0:11,15}"},{631, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{663, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},
		{695, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{712, "r{b0:6,10}, r{b0:11,15}"},{714, "r{b0:6,10}, r{b0:11,15}"},{725, "r{b0:6,10}, r{b0:11,15}, {b0:X16,20}"},{727, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},
		{744, "r{b0:6,10}, r{b0:11,15}"},{746, "r{b0:6,10}, r{b0:11,15}"},{758, "r{b0:11,15}, r{b0:16,20}"},{792, "r{b0:11,15}, r{b0:6,10}, r{b0:16,20}"},{824, "r{b0:11,15}, r{b0:6,10}, {b0:X16,20}"},{854,"{b0:}"},
		{922, "r{b0:11,15}, r{b0:6,10}"},{954, "r{b0:11,15}, r{b0:6,10}"},{982, "r{b0:11,15}, r{b0:16,20}"},{983, "fr{b0:6,10}, r{b0:11,15}, r{b0:16,20}"},{1014, "r{b0:11,15}, r{b0:16,20}"}
		});

	static const std::unordered_map<ulong, std::string> secondary_patterns_float({
		{18, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},{20, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},{21, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},{22, "fr{b0:6,10}, fr{b0:16,20}"},{24, "fr{b0:6,10}, fr{b0:16,20}"},
		{25, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}"}
		});

	static const std::unordered_map<ulong, std::string> secondary_patterns_double({
		{0, "crf{b0:6,8}, fr{b0:11,15}, fr{b0:16,20}"},{12, "fr{b0:6,10}, fr{b0:16,20}"},{14, "fr{b0:6,10}, fr{b0:16,20}"},{15, "fr{b0:6,10}, fr{b0:16,20}"},{18, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},
		{20, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},{21, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:16,20}"},{22, "fr{b0:6,10}, fr{b0:16,20}"},{23, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},
		{25, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}"},{26, "fr{b0:6,10}, fr{b0:16,20}"},{28, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},{29, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},
		{30, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},{31, "fr{b0:6,10}, fr{b0:11,15}, fr{b0:21,25}, fr{b0:16,20}"},{32, "crf{b0:6,8}, fr{b0:11,15}, fr{b0:16,20}"},{38, "crb{b0:6,10}"},
		{40, "fr{b0:6,10}, fr{b0:16,20}"},{64, "crf{b0:6,8}, crf{b0:11,13}"},{70, "crb{b0:6,10}"},{72, "fr{b0:6,10}, fr{b0:16,20}"},{134, "crf{b0:6,8}, {b0:X16,19}"},{136, "fr{b0:6,10}, fr{b0:16,20}"},
		{264, "fr{b0:6,10}, fr{b0:16,20}"},{583, "fr{b0:6,10}, fr{b0:16,20}"},{711, "{b0:X7,14}, fr{b0:16,20}"}
		});

	// Codes without destination register

	static const std::set<ulong> primary_missing_dest({3, 16, 17, 18, 19, 36, 37, 38, 39, 44, 45, 47, 52, 53, 54, 55});

	static const std::set<ulong> secondary_missing_dest_math({4, 54, 86, 144, 146, 150, 151, 183, 210, 215, 242, 246, 247, 278, 306, 370, 407, 438, 439, 467, 470,
															566, 598, 661, 662, 663, 695, 725, 727, 758, 759, 854, 918, 982, 983, 1014});

	static const std::set<ulong> secondary_missing_dest_double({711});

}